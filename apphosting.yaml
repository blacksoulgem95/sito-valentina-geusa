# Configurazione Firebase App Hosting
# Per maggiori informazioni: https://firebase.google.com/docs/app-hosting/configure

# Impostazioni Cloud Run per il backend
runConfig:
  # Numero di CPU per istanza (default: 0, auto-scaling)
  cpu: 1
  # Memoria in MiB (default: 512)
  # Nota: pi√π di 4 GiB richiedono almeno 2 CPU
  memoryMiB: 1024
  # Numero minimo di istanze sempre attive (default: 0)
  minInstances: 0
  # Numero massimo di istanze (default: 100)
  maxInstances: 10
  # Concorrenza: richieste simultanee per istanza (default: 80)
  concurrency: 80

# Variabili d'ambiente e secret
env:
  # ============================================
  # Variabili Firebase (PUBLIC_ per client-side)
  # ============================================
  # Queste variabili sono disponibili sia in BUILD che in RUNTIME
  - variable: PUBLIC_FIREBASE_API_KEY
    value: your_firebase_api_key_here
    availability:
      - BUILD
      - RUNTIME

  - variable: PUBLIC_FIREBASE_AUTH_DOMAIN
    value: your_project_id.firebaseapp.com
    availability:
      - BUILD
      - RUNTIME

  - variable: PUBLIC_FIREBASE_PROJECT_ID
    value: your_project_id
    availability:
      - BUILD
      - RUNTIME

  - variable: PUBLIC_FIREBASE_STORAGE_BUCKET
    value: your_project_id.appspot.com
    availability:
      - BUILD
      - RUNTIME

  - variable: PUBLIC_FIREBASE_MESSAGING_SENDER_ID
    value: your_messaging_sender_id
    availability:
      - BUILD
      - RUNTIME

  - variable: PUBLIC_FIREBASE_APP_ID
    value: your_firebase_app_id
    availability:
      - BUILD
      - RUNTIME

  # ============================================
  # Configurazione Server
  # ============================================
  # Host: ascolta su tutte le interfacce (necessario per Cloud Run)
  - variable: HOST
    value: "0.0.0.0"
    availability:
      - RUNTIME

  # Porta: Cloud Run imposta automaticamente PORT, ma possiamo specificarla
  # - variable: PORT
  #   value: "8080"
  #   availability:
  #     - RUNTIME

  # ============================================
  # Variabili Mailgun (SERVER-SIDE ONLY)
  # ============================================
  # IMPORTANTE: Queste variabili contengono informazioni sensibili
  # Dovrebbero essere configurate come SECRET in Cloud Secret Manager
  # Vedi apphosting.md per le istruzioni complete
  
  # Esempio con valori diretti (NON RACCOMANDATO per produzione):
  # - variable: MAILGUN_DOMAIN
  #   value: your_mailgun_domain.com
  #   availability:
  #     - RUNTIME
  
  # Esempio con Secret Manager (RACCOMANDATO):
  # - variable: MAILGUN_DOMAIN
  #   secret: mailgun-domain-secret
  #   availability:
  #     - RUNTIME
  
  # - variable: MAILGUN_API_KEY
  #   secret: mailgun-api-key-secret
  #   availability:
  #     - RUNTIME
  
  # - variable: CONTACT_EMAIL
  #   secret: contact-email-secret
  #   availability:
  #     - RUNTIME

# Script personalizzati (opzionale)
# App Hosting rileva automaticamente Astro, ma puoi sovrascrivere se necessario
# scripts:
#   buildCommand: npm run build
#   runCommand: node dist/server/entry.mjs

# Configurazione output build (opzionale)
# App Hosting ottimizza automaticamente, ma puoi specificare cosa includere
# outputFiles:
#   serverApp:
#     include: [dist, public]
